## 요구사항

리스트 조회, 등록 기능을 구현하기전에 우선 회원 기능을 구현해야 한다.

DB 를 바로 붙히기는 부담스러우니 내가 평소에 작업 하던 방식으로 작업을 진행하자.

우선 기능을 대충이라도 구현하고 해당 기능을 고도화 하는 방향으로 진행하자.

그러니 node js 내부 메모리에 회원을 등록 시키고 로그인 하는 방법으로 진행할 것이다.

```ts
const users:User[] = []
const links:Link[] = []
```

위와 같이 메모리에 배열을 생성해서 회원 정보를 관리할 것이다.

물론 node 가 다시 시작되면 초기화 되니 테스트 데이터를 미리 넣어놓으면 편할 것 같다.

## 진행과정

### 회원가입

회원가입은 파일을 사용해서 구현했다.

`fs.readFileSync` 와 `fs.writeFileSync` 를 사용해 읽고 쓰기를 구현했다.

이제 로그인 기능을 구현해보자.

### 로그인

```ts
// 로그인
app.post('/auth/login', async (req, res) => {
  const { email, password } = req.body ?? {};
  if (!email || !password) return res.status(400).json({ message: 'email, password 필요' });

  const user = users.find(u => u.email === email);
  if (!user) return res.status(401).json({ message: '이메일 또는 비밀번호가 올바르지 않습니다' });

  const ok = await bcrypt.compare(password, user.passwordHash);
  if (!ok) return res.status(401).json({ message: '이메일 또는 비밀번호가 올바르지 않습니다' });

  const token = jwt.sign({ sub: user.id }, JWT_SECRET, { expiresIn: '7d' });
  return res.json({ token });
});

```

위와 같이 로그인을 구현하면 된다고 한다.

그전에 라우트를 분리할거라 일단은 좀이따 하자.


